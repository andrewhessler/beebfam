<head>
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <link rel="stylesheet" href="/assets/index.css" />
  <title>Beebfam Hub</title>
</head>

<body>
  <div id="root">
    <div id="locations">
      <div class="fw">
        <a href="https://ainbox.beebfam.org"><button class="fw">Andrew Inbox</button></a>
      </div>
      <div class="fw">
        <a href="https://chores.beebfam.org"><button class="fw">Chores</button></a>
      </div>
      <div class="fw">
        <a href="https://exercise.beebfam.org"><button class="fw">Exercise</button></a>
      </div>
      <div class="fw">
        <a href="https://mario.beebfam.org"><button class="fw">Mario</button></a>
      </div>
      <div class="fw">
        <a href="https://media.beebfam.org"><button class="fw">Media</button></a>
      </div>
      <div class="fw">
        <a href="https://supply.beebfam.org"><button class="fw">Shopping</button></a>
      </div>
    </div>

    <div id="login-block">
      <input type="text" id="password" onfocus="this.value = this.value === 'Login needed' ? '' : this.value" /> <button onclick="login()">Login</button>
    </div>

    <div id="light-control" class="fw">
      <button class="fw" onclick="turnOffLights()">Lights Off</button>
      <div class="light-control-group">
        <button class="hw" onclick="toggleLivingRoom(true)">Living Room On</button>
        <button class="hw" onclick="toggleLivingRoom(false)">Living Room Off</button>
      </div>
      <div class="light-control-group">
        <button class="hw" onclick="toggleBedroom(true)">Bedroom On</button>
        <button class="hw" onclick="toggleBedroom(false)">Bedroom Off</button>
      </div>
      <div class="light-control-group">
        <button class="hw" onclick="toggleStudio(true)">Studio On</button>
        <button class="hw" onclick="toggleStudio(false)">Studio Off</button>
      </div>
    </div>
  </div>

  <script>
    const login = async () => {
      const password = document.getElementById("password");
      const response = await fetch('/login', {
        method: "POST",
        body: JSON.stringify({
          password: password.value
        }),
        headers: {
          "Content-Type": "application/json"
        }
      })

      if (!response.ok) {
        password.value = "Login needed";
      } else {
        password.value = "Logged In!";
      }
    }
    login()
    const turnOffLights = async () => {
      const response = await fetch('/light-control', {
        method: "POST",
        body: JSON.stringify({
          requests: [
            {
              name: "tall living room",
              toggle: false,
            },
            {
              name: "small living room",
              toggle: false,
            },
            {
              name: "bubble lamp",
              toggle: false,
            },
            {
              name: "bedroom black",
              toggle: false,
            },
            {
              name: "studio lights",
              toggle: false,
            },
          ]
        }),
        headers: {
          "Content-Type": "application/json"
        }
      })
    }
    const toggleLivingRoom = async (onOff) => {
      const response = await fetch('/light-control', {
        method: "POST",
        body: JSON.stringify({
          requests: [
            {
              name: "tall living room",
              toggle: onOff,
            },
            {
              name: "small living room",
              toggle: onOff,
            },
          ]
        }),
        headers: {
          "Content-Type": "application/json"
        }
      })
    }
    const toggleBedroom = async (onOff) => {
      const response = await fetch('/light-control', {
        method: "POST",
        body: JSON.stringify({
          requests: [
            {
              name: "bedroom black",
              toggle: onOff,
            },
          ]
        }),
        headers: {
          "Content-Type": "application/json"
        }
      })
    }
    const toggleStudio = async (onOff) => {
      const response = await fetch('/light-control', {
        method: "POST",
        body: JSON.stringify({
          requests: [
            // {
            //   name: "bubble lamp",
            //   toggle: true,
            // },
            {
              name: "studio lights",
              toggle: onOff,
            },
          ]
        }),
        headers: {
          "Content-Type": "application/json"
        }
      })
    }
  </script>
</body>

