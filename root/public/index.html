<head>
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <link rel="stylesheet" href="./assets/index.css" />
  <title>Beebfam Hub</title>
</head>

<body>
  <div id="root">
    <div class="locations">
      <div class="app-container">
        <a href="https://ainbox.beebfam.org"><button class="app-icon">ğŸ“¬</button></a>
        <div class="app-label">Andrew Inbox</div>
      </div>
      <div class="app-container">
        <a href="https://chores.beebfam.org"><button class="app-icon">ğŸ§¼</button></a>
        <div class="app-label">Chores</div>
      </div>
      <div class="app-container">
        <a href="https://exercise.beebfam.org"><button class="app-icon">ğŸš²</button></a>
        <div class="app-label">Exercise</div>
      </div>
    </div>
    <div class="locations">
      <div class="app-container">
        <a href="https://mario.beebfam.org"><button class="app-icon">ğŸ</button></a>
        <div class="app-label">Mario</div>
      </div>
      <div class="app-container">
        <a href="https://media.beebfam.org"><button class="app-icon">ğŸ“š</button></a>
        <div class="app-label">Media</div>
      </div>
      <div class="app-container">
        <a href="https://supply.beebfam.org"><button class="app-icon">ğŸ›’</button></a>
        <div class="app-label">Shopping</div>
      </div>
    </div>
    <div class="locations">
      <div class="app-container">
        <a href="https://habit.beebfam.org"><button class="app-icon">ğŸ“‹</button></a>
        <div class="app-label">Habits</div>
      </div>
    </div>

    <div id="login-block">
      <input type="text" id="password" onfocus="this.value = this.value === 'Login needed' ? '' : this.value" /> 
      <button id="login-button" onclick="login()">Login</button>
    </div>

    <div id="light-control" class="fw">
      <button class="hw" onclick="turnOffLights()">Lights Off</button>
      <div class="granular-light-control">
        <div class="light-control-group">
          <div class="on-off-container">
            <button class="light-switch" onclick="toggleLights(['small living room', 'tall living room'], true)">On</button>
            <button class="light-switch" onclick="toggleLights(['small living room', 'tall living room'], false)">Off</button>
          </div>
          <div class="light-control-label">Living Room</div>
        </div>
        <div class="light-control-group">
          <div class="on-off-container">
            <button class="light-switch" onclick="toggleLights(['bedroom black'], true)">On</button>
            <button class="light-switch" onclick="toggleLights(['bedroom black'], false)">Off</button>
          </div>
          <div class="light-control-label">Bedroom</div>
        </div>
        <div class="light-control-group">
          <div class="on-off-container">
            <button class="light-switch" onclick="toggleLights(['small living room'] ,true)">On</button>
            <button class="light-switch" onclick="toggleLights(['small living room'], false)">Off</button>
          </div>
          <div class="light-control-label">Small Lamp</div>
        </div>
        <div class="light-control-group">
          <div class="on-off-container">
            <button class="light-switch" onclick="toggleLights(['tall living room'], true)">On</button>
            <button class="light-switch" onclick="toggleLights(['tall living room'], false)">Off</button>
          </div>
          <div class="light-control-label">Tall Lamp</div>
        </div>
        <div class="light-control-group">
          <div class="on-off-container">
            <button class="light-switch" onclick="toggleLights(['studio lights'], true)">On</button>
            <button class="light-switch" onclick="toggleLights(['studio lights'], false)">Off</button>
          </div>
          <div class="light-control-label">Studio</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const login = async () => {
      const password = document.getElementById("password");
      const response = await fetch('/login', {
        method: "POST",
        body: JSON.stringify({
          password: password.value
        }),
        headers: {
          "Content-Type": "application/json"
        }
      })

      if (!response.ok) {
        password.value = "Login needed";
      } else {
        password.value = "Logged In!";
      }
    }
    login()
    const toggleLights = async (lightArray, onOff) => {
      const response = await fetch('/light-control', {
        method: "POST",
        body: JSON.stringify({
          requests: lightArray.map((light) => ({
            name: light,
            toggle: onOff,
          }))
        }),
        headers: {
          "Content-Type": "application/json"
        }
      })
    }

    const turnOffLights = async () => { toggleLights([
      'small living room',
      'tall living room',
      'bubble lamp',
      'bedroom black',
      'studio lights'
    ], false)}
  </script>
</body>

